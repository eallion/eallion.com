<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>汇率转换器</title><link rel="icon" type="image/png" sizes="32x32" href="https://images.eallion.com/eallion_round.png" /><script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script><style>:root{ --bg-primary: #ffffff; --bg-secondary: #f8f9fa; --bg-card: #ffffff; --text-primary: #1a1a1a; --text-secondary: #4d4d4d; --accent-primary: #5e6ad2; --accent-secondary: #7c3aed; --border-color: #e5e7eb; --shadow: 0 4px 12px rgba(0, 0, 0, 0.05); --transition: all 0.3s ease; --btc-color: #f7931a;} .dark-mode{ --bg-primary: #121212; --bg-secondary: #1e1e1e; --bg-card: #242424; --text-primary: #f5f5f5; --text-secondary: #a3a3a3; --accent-primary: #818cf8; --accent-secondary: #a78bfa; --border-color: #333333; --shadow: 0 4px 12px rgba(0, 0, 0, 0.2); --btc-color: #f9b44e;} *{ margin: 0; padding: 0; box-sizing: border-box; transition: var(--transition);} body{ font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background-color: var(--bg-primary); color: var(--text-primary); line-height: 1.6; min-height: 100vh; display: flex; flex-direction: column;} .container{ max-width: 1600px; margin: 0 auto; padding: 0 30px;} header{ padding: 32px 0; text-align: center; background-color: var(--bg-secondary); border-bottom: 1px solid var(--border-color); margin-bottom: 40px;} h1{ font-size: 2.5rem; font-weight: 700; margin-bottom: 12px; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; background-clip: text; color: transparent;} .subtitle{ font-size: 1.1rem; color: var(--text-secondary); max-width: 600px; margin: 0 auto;} .theme-toggle{ position: absolute; top: 20px; right: 20px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: var(--shadow); transition: var(--transition);} .theme-toggle:hover{ transform: scale(1.05); box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);} .control-panel{ display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 30px; align-items: center; justify-content: center;} .base-currency-selector{ position: relative;} .base-currency-btn{ width: 100%; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px 16px; font-size: 1rem; font-weight: 500; display: flex; align-items: center; gap: 8px; cursor: pointer; box-shadow: var(--shadow);} .base-currency-btn:hover{ border-color: var(--accent-primary);} .currency-dropdown{ position: absolute; top: 100%; left: 0; width: 100%; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; box-shadow: var(--shadow); z-index: 10; max-height: 300px; overflow-y: auto; display: none; margin-top: 8px;} .currency-dropdown.show{ display: block; animation: fadeIn 0.3s ease;} .currency-option{ padding: 12px 16px; cursor: pointer; display: flex; align-items: center; gap: 8px;} .currency-option:hover{ background-color: rgba(94, 106, 210, 0.1);} .date-display{ background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px 16px; font-size: 0.9rem; color: var(--text-secondary); box-shadow: var(--shadow);} .alipay-display, .abchina-display{ display: flex; align-items: center; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px 16px; font-size: 0.9rem; color: var(--text-secondary); box-shadow: var(--shadow);} .alipay-display iconify-icon, .abchina-display svg{ margin-bottom: -0.125rem;} .primary-currencies{ display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-bottom: 40px;} .primary-currency-card{ background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 16px; padding: 30px; box-shadow: var(--shadow); animation: fadeIn 0.5s ease; position: relative; z-index: 2;} .primary-currency-card.usd{ border-left-width: 4px; border-left-color: var(--accent-primary);} .primary-currency-card.cny{ border-left-width: 4px; border-left-color: #de2910;} .primary-currency-card.btc{ border-left-width: 4px; border-left-color: var(--btc-color);} .primary-currency-card:hover{ transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15); border-color: var(--accent-primary);} .currency-header{ display: flex; align-items: center; gap: 12px; margin-bottom: 20px;} .currency-flag{ width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: var(--bg-secondary); font-size: 28px;} .btc-flag{ background: var(--btc-color); color: white;} .currency-info{ flex: 1;} .currency-code{ font-size: 1.5rem; font-weight: 700;} .btc-code{ color: var(--btc-color);} .currency-name{ font-size: 1rem; color: var(--text-secondary);} .currency-input{ width: 100%; padding: 18px 20px; font-size: 1.5rem; border: 1px solid var(--border-color); border-radius: 12px; background: var(--bg-secondary); color: var(--text-primary); transition: var(--transition); font-weight: 500;} .currency-input:focus{ outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.2);} .currency-rate{ margin-top: 16px; font-size: 1.1rem; color: var(--text-secondary); text-align: right;} .btc-load-btn{ display: flex; align-items: center; justify-content: center; gap: 8px; background: var(--btc-color); color: white; border: none; border-radius: 8px; padding: 12px 20px; font-size: 1rem; font-weight: 500; cursor: pointer; transition: var(--transition); margin-top: 20px; width: 100%;} .btc-load-btn:hover{ background: #e0820d; transform: translateY(-2px);} .btc-load-btn:disabled{ background: #aaa; cursor: not-allowed;} .secondary-currencies{ display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; margin-bottom: 60px;} .currency-card{ background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; box-shadow: var(--shadow); transition: var(--transition); animation: fadeIn 0.5s ease; height: 180px; display: flex; flex-direction: column; justify-content: space-between;} .currency-card:hover{ transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); border-color: var(--accent-primary);} .currency-card .currency-flag{ width: 36px; height: 36px; font-size: 20px;} .currency-card .currency-code{ font-size: 1.1rem;} .currency-card .currency-name{ font-size: 0.85rem;} .currency-card .currency-input{ padding: 10px 12px; font-size: 1.1rem;} .currency-card .currency-rate{ font-size: 0.9rem; margin-top: 8px;} footer{ background: var(--bg-secondary); border-top: 1px solid var(--border-color); padding: 40px 0; margin-top: auto;} .author-info{ text-align: center;} .author-name{ font-size: 1.1rem; font-weight: 600; margin-bottom: 16px;} .social-links{ display: flex; justify-content: center; gap: 20px; margin-bottom: 20px;} .social-link{ display: flex; align-items: center; gap: 6px; color: var(--text-secondary); text-decoration: none; transition: var(--transition);} .social-link:hover{ color: var(--accent-primary); transform: translateY(-2px);} .copyright{ font-size: 0.9rem; color: var(--text-secondary);} .loader{ display: flex; justify-content: center; align-items: center; height: 300px;} .spinner{ width: 50px; height: 50px; border: 4px solid rgba(94, 106, 210, 0.2); border-top: 4px solid var(--accent-primary); border-radius: 50%; animation: spin 1s linear infinite;} .btc-spinner{ border-top-color: var(--btc-color);} @keyframes spin{ 0%{ transform: rotate(0deg);} 100%{ transform: rotate(360deg);}} @keyframes fadeIn{ from{ opacity: 0; transform: translateY(10px);} to{ opacity: 1; transform: translateY(0);}} @media (max-width: 1200px){ .primary-currencies{ grid-template-columns: repeat(2, 1fr);} .primary-currency-card.btc{ grid-column: span 2;}} @media (max-width: 900px){ .primary-currencies{ grid-template-columns: 1fr;} .primary-currency-card.btc{ grid-column: span 1;}} @media (max-width: 768px){ h1{ font-size: 2rem;} .secondary-currencies{ grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));} .control-panel{ flex-direction: column; align-items: stretch;} .primary-currency-card{ padding: 24px;}} @media (max-width: 600px){ .secondary-currencies{ grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));}} @media (max-width: 480px){ h1{ font-size: 1.75rem;} .currency-card, .primary-currency-card{ padding: 18px;} .currency-input{ font-size: 1.3rem; padding: 14px 16px;} .secondary-currencies{ grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px;} .currency-card{ height: 220px;} .currency-card .currency-rate{ font-size: 0.75rem; text-align: center;}} </style></head><body><header><button class="theme-toggle" id="themeToggle" aria-label="切换主题"><iconify-icon icon="ph:sun-dim" width="24" height="24"></iconify-icon></button><h1>汇率转换器</h1><p class="subtitle">支持法定货币与比特币的实时转换</p></header><div class="container"><main><div class="control-panel"><div class="base-currency-selector"><button class="base-currency-btn" id="baseCurrencyBtn"><iconify-icon icon="ph:currency-dollar" width="20" height="20"></iconify-icon><span>基准货币：USD</span><iconify-icon icon="ph:caret-down" width="16" height="16"></iconify-icon></button><div class="currency-dropdown" id="currencyDropdown"></div></div><div class="date-display" id="dateDisplay">汇率日期：加载中... </div><div class="alipay-display" id="alipayCurrency"><iconify-icon icon="famicons:logo-alipay" width="1em" height="1em" style="color: #1E6FFF "></iconify-icon>支付宝汇率：<a href="https://render.alipay.com/p/s/currency-converter-sem/" target="_blank" rel="noopener noreferrer">查看</a></div><div class="abchina-display" id="abchinaCurrency"><svg t="1752731057875" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1854" width="1em" height="1em"><path d="M465.621333 2.176L489.429333 0h47.317334l21.674666 2.176v314.069333l-2.218666 2.176-2.176 4.266667h-2.176l-2.133334 2.133333-6.485333 2.176h-60.330667l-6.4-2.176-2.304-2.133333h-4.266666v-4.266667l-2.133334-2.176-2.176-8.533333V2.176z m217.6 507.733333v152.704l-2.176 4.266667-2.176 2.133333-2.176 4.266667h-4.266666l-4.266667 2.176-8.533333 2.176h-90.368v241.066667l19.328-4.266667 19.456-2.176 17.322666-6.4 17.28-4.266667 8.533334-2.133333 8.533333-4.266667 17.28-6.485333 17.28-8.533333 15.104-8.533334 17.066667-8.533333 15.104-8.533333 12.8-10.624 15.104-10.837334 28.117333-23.722666 12.8-12.8 10.794667-12.8 12.8-14.976 10.794666-12.8 10.794667-14.976 8.533333-15.104 8.533334-17.066667 8.533333-15.104 8.533333-17.066667 6.442667-17.28 10.837333-34.517333 6.442667-17.066667 2.176-19.413333 4.266667-17.066667 2.176-19.285333 2.986666-40.064-2.176-30.08-2.176-15.104v-15.402667l-6.485333-29.866666-8.533333-30.208-4.266667-12.8-4.266667-12.8-10.666666-27.946667-15.488-25.6-12.8-25.6-17.066667-21.333333-19.370667-23.722667-19.413333-21.333333-21.333333-19.413334-21.333334-17.066666-23.808-17.066667-25.856-15.104-25.898666-12.8V490.666667l-2.176 4.266666-2.176 2.176-2.176 4.266667-4.266667 2.176h-4.266667l-8.533333 2.133333h-128l-2.133333 2.176-2.176 2.176V361.344l2.176-4.266667 2.133333-4.266666 4.266667-2.176h58.282666l8.533334-2.176 6.442666-2.133334 4.266667-2.176 4.266667-6.4V10.666667l42.965333 12.8 21.632 6.442666 19.285333 6.4 21.333334 8.533334 19.285333 10.922666 19.498667 8.533334 17.28 10.922666 19.285333 12.8 17.322667 10.624 17.28 12.8 15.018666 14.976 17.322667 15.104 15.104 15.018667 27.946667 30.336 12.8 17.066667 12.8 17.28 10.666666 19.285333 10.794667 17.066667 21.333333 38.698666 8.533334 19.456 6.485333 21.333334 12.8 40.917333 6.4 21.333333 4.266667 21.589334 2.133333 21.333333 4.266667 23.765333V537.6l-2.176 25.984-2.176 25.6-4.266667 25.6-6.442667 23.765333-6.4 25.6-8.533333 23.637334-8.533333 21.674666-10.709334 23.509334-10.922666 21.333333-12.8 21.589333-12.8 21.333334-15.104 19.285333-15.104 19.285333-15.018667 19.541334-17.066667 17.066666-17.322666 17.28-19.413334 14.976-19.328 15.018667-19.328 15.104-21.333333 12.8-21.333333 12.8-21.674667 10.624-23.637333 10.709333-21.333334 8.533334-25.941333 8.533333-23.637333 6.613333-23.808 6.442667-25.941334 4.266667-25.898666 2.133333-25.856 2.176-25.386667 3.584-25.898667-2.176-25.856-2.048-25.941333-2.133333-25.898667-4.266667-25.856-6.442667-23.808-6.570666-23.765333-8.533334-23.68-8.533333-21.632-10.624-21.333333-10.666667-21.632-12.8-21.333334-12.8-19.456-15.104-19.285333-14.976-19.498667-15.018666-17.066666-17.28-17.066667-17.322667-17.28-19.456-15.317333-19.712-12.8-19.285333-12.8-21.333334-12.8-21.589333-10.624-21.589333-11.562667-23.637334-8.533333-21.674666-8.533334-23.637334-6.442666-25.6-6.4-23.765333-4.266667-25.856-4.266667-25.6L0 537.6v-49.322667l2.176-21.333333 2.176-23.765333 4.266667-21.333334 4.266666-21.589333 4.266667-21.333333 12.8-40.874667 8.533333-21.333333 8.533334-19.413334 8.533333-19.285333 10.624-19.413333 10.837333-17.066667 12.8-19.285333 12.8-17.28 12.8-17.066667 12.8-15.232 16-15.744 15.146667-14.976 14.72-15.146667 34.517333-25.6 17.28-12.8 17.28-12.8 19.456-10.922666 19.2-8.533334 19.456-10.922666 19.456-8.533334 19.498667-6.528 21.589333-6.442666 21.333334-6.656 21.333333-6.357334V337.92l2.176 4.266667 2.176 2.133333 6.485333 2.176 6.4 2.176 6.442667 2.176h58.666667l4.266666 2.176 4.266667 4.266667v152.832l-4.266667-4.266667H363.904l-8.533333-2.133333h-4.266667l-2.176-2.176-4.266667-4.266667-2.133333-2.176V490.666667l-2.176-6.442667V137.642667l-25.941333 12.8-23.637334 15.104-23.125333 17.066666-23.637333 17.28-21.333334 19.413334-19.456 21.333333-17.792 23.893333-17.28 23.637334-15.018666 23.594666-12.8 25.6-6.442667 12.8-4.266667 14.976-11.008 28.458667-6.485333 28.032-6.4 29.866667-2.176 15.232v15.402666l-2.005333 29.866667v19.285333l2.133333 19.456 2.176 17.066667 2.176 19.285333 4.266667 19.413334 4.266666 17.066666 6.4 17.066667 2.261334 8.533333 4.266666 8.533334 6.4 17.066666 6.442667 17.28 17.493333 33.28 21.333334 27.904 10.709333 15.189334 10.794667 15.018666 12.8 12.8 12.8 12.8 25.856 23.722667 15.104 10.794667 15.018666 10.666666 30.165334 17.28 17.28 8.533334 15.018666 8.533333 17.322667 6.442667 17.066667 6.485333 19.328 4.266667 17.322666 6.314666 17.066667 2.176 19.328 4.266667v-240.896H364.373333l-8.533333-2.176-2.133333-2.176h-4.266667l-4.266667-4.266667-2.176-2.133333v-4.266667l-2.517333-6.442666v-146.389334l2.261333 2.218667 2.176 2.176 6.485334 4.266667 6.4 2.133333 6.442666 2.176h122.88l4.266667 2.176 4.266667 4.266667v146.346666h32.426666V533.333333l2.176-4.266666 2.133334-4.266667 4.266666-2.176h122.88l6.442667-2.133333 6.485333-2.176 6.4-4.266667 4.266667-4.266667z" fill="#009174" p-id="1855"></path></svg>农行汇率：<a href="https://ewealth.abchina.com/foreignexchange/listprice/" target="_blank" rel="noopener noreferrer">查看</a></div></div><div class="primary-currencies" id="primaryCurrencies"></div><h2 style="margin-bottom:20px; padding:0 10px;">其他货币</h2><div class="secondary-currencies" id="secondaryCurrencies"></div></main></div><footer><div class="container"><div class="author-info"><div class="author-name">汇率转换器</div><div class="social-links"><a href="https://github.com/eallion" class="social-link" target="_blank"><iconify-icon icon="mdi:github" width="20" height="20"></iconify-icon><span>GitHub</span></a><a href="https://e5n.cc/@eallion" class="social-link" target="_blank"><iconify-icon icon="mdi:mastodon" width="20" height="20"></iconify-icon><span>Mastodon</span></a></div><div class="copyright">&copy; <span id="currentYear"></span>汇率转换器 </div></div></div></footer><script>// 设置当前年份 document.getElementById('currentYear').textContent=new Date().getFullYear(); // 主题切换功能 const themeToggle=document.getElementById('themeToggle'); const prefersDarkScheme=window.matchMedia('(prefers-color-scheme: dark)'); // 初始主题设置 if (prefersDarkScheme.matches){ document.body.classList.add('dark-mode'); themeToggle.innerHTML='<iconify-icon icon="ph:moon" width="24" height="24"></iconify-icon>';} themeToggle.addEventListener('click', ()=>{ document.body.classList.toggle('dark-mode'); if (document.body.classList.contains('dark-mode')){ themeToggle.innerHTML='<iconify-icon icon="ph:moon" width="24" height="24"></iconify-icon>';} else{ themeToggle.innerHTML='<iconify-icon icon="ph:sun-dim" width="24" height="24"></iconify-icon>';}}); // 货币数据 let exchangeRates={}; let baseCurrency='USD'; let currencies=[]; let currencyNames={ USD: '美元', EUR: '欧元', JPY: '日元', GBP: '英镑', CNY: '人民币', AUD: '澳元', CAD: '加元', CHF: '瑞士法郎', HKD: '港元', SGD: '新加坡元', SEK: '瑞典克朗', NZD: '新西兰元', MXN: '墨西哥比索', INR: '印度卢比', BRL: '巴西雷亚尔', KRW: '韩元', TRY: '土耳其里拉', ZAR: '南非兰特', PLN: '波兰兹罗提', THB: '泰铢', IDR: '印尼盾', HUF: '匈牙利福林', CZK: '捷克克朗', DKK: '丹麦克朗', NOK: '挪威克朗', ILS: '以色列新谢克尔', PHP: '菲律宾比索', AED: '阿联酋迪拉姆', SAR: '沙特里亚尔', MYR: '马来西亚林吉特', RON: '罗马尼亚列伊', BGN: '保加利亚列弗', ISK: '冰岛克朗', BTC: '比特币'}; // 货币图标映射 const currencyIcons={ USD: 'twemoji:flag-united-states', EUR: 'twemoji:flag-european-union', JPY: 'twemoji:flag-japan', GBP: 'twemoji:flag-united-kingdom', CNY: 'twemoji:flag-china', AUD: 'twemoji:flag-australia', CAD: 'twemoji:flag-canada', CHF: 'twemoji:flag-switzerland', HKD: 'twemoji:flag-hong-kong-sar-china', SGD: 'twemoji:flag-singapore', SEK: 'twemoji:flag-sweden', NZD: 'twemoji:flag-new-zealand', MXN: 'twemoji:flag-mexico', INR: 'twemoji:flag-india', BRL: 'twemoji:flag-brazil', KRW: 'twemoji:flag-south-korea', TRY: 'twemoji:flag-turkey', ZAR: 'twemoji:flag-south-africa', PLN: 'twemoji:flag-poland', THB: 'twemoji:flag-thailand', IDR: 'twemoji:flag-indonesia', HUF: 'twemoji:flag-hungary', CZK: 'twemoji:flag-czechia', DKK: 'twemoji:flag-denmark', NOK: 'twemoji:flag-norway', ILS: 'twemoji:flag-israel', PHP: 'twemoji:flag-philippines', AED: 'twemoji:flag-united-arab-emirates', SAR: 'twemoji:flag-saudi-arabia', MYR: 'twemoji:flag-malaysia', RON: 'twemoji:flag-romania', BGN: 'twemoji:flag-bulgaria', ISK: 'twemoji:flag-iceland', BTC: 'cryptocurrency:btc'}; // DOM 元素 const baseCurrencyBtn=document.getElementById('baseCurrencyBtn'); const currencyDropdown=document.getElementById('currencyDropdown'); const dateDisplay=document.getElementById('dateDisplay'); const primaryCurrencies=document.getElementById('primaryCurrencies'); const secondaryCurrencies=document.getElementById('secondaryCurrencies'); // 获取汇率数据 async function fetchExchangeRates(){ try{ primaryCurrencies.innerHTML='<div class="loader"><div class="spinner"></div></div>'; secondaryCurrencies.innerHTML=''; const response=await fetch(`https://api.vatcomply.com/rates?base=${baseCurrency}`); const data=await response.json(); exchangeRates=data.rates; currencies=Object.keys(exchangeRates); // 更新日期显示 dateDisplay.innerHTML=`汇率日期：<a href="https://api.vatcomply.com/rates?base=USD" target="_blank" rel="noopener noreferrer">${data.date}</a>`; // 生成货币下拉菜单 generateCurrencyDropdown(); // 生成货币卡片 generateCurrencyCards(); // 设置初始值 document.querySelector(`.primary-currency-card[data-currency="${baseCurrency}"] .currency-input`).value=1; updateAllCurrencies(baseCurrency, 1); updateAllCurrencyRates(baseCurrency);} catch (error){ console.error('获取汇率数据失败：', error); primaryCurrencies.innerHTML='<div class="error">无法加载汇率数据，请稍后再试。</div>';}} // 获取比特币汇率并设为基准 async function fetchBitcoinRates(){ try{ const btcLoadBtn=document.getElementById('loadBtcBtn'); btcLoadBtn.innerHTML='<div class="spinner btc-spinner" style="width:20px;height:20px;"></div>加载中...'; btcLoadBtn.disabled=true; const response=await fetch('https://blockchain.info/ticker'); const data=await response.json(); // 获取当前基准货币的比特币汇率 const baseRate=data[baseCurrency]?.last; if (baseRate){ // 创建新的汇率对象，以比特币为基准 const newRates={}; // 计算所有货币相对于比特币的汇率 for (const currency in exchangeRates){ // 1 BTC=baseRate 基准货币 // 1 基准货币=exchangeRates[currency] 其他货币 // 所以 1 BTC=baseRate * exchangeRates[currency] 其他货币 newRates[currency]=baseRate * exchangeRates[currency];} // 添加比特币本身 newRates['BTC']=1; // 更新汇率对象 exchangeRates=newRates; // 更新比特币卡片 const btcCard=document.querySelector('.primary-currency-card.btc'); if (btcCard){ // 显示输入框 btcCard.querySelector('.currency-input').style.display='block'; // 移除加载按钮 btcLoadBtn.remove(); // 更新汇率显示 btcCard.querySelector('.currency-rate').innerHTML=` 1 BTC=${baseRate.toFixed(2)} ${baseCurrency} `;} // 更新所有货币卡片显示 updateAllCurrencyRates('BTC'); // 设置比特币输入框为 1 document.querySelector('.primary-currency-card.btc .currency-input').value=1; // 更新所有货币值（以比特币为基准）updateAllCurrencies('BTC', 1);}} catch (error){ console.error('获取比特币汇率失败：', error); alert('无法加载比特币汇率数据，请稍后再试。');}} // 生成货币下拉菜单 function generateCurrencyDropdown(){ currencyDropdown.innerHTML=''; currencies.forEach(currency=>{ const option=document.createElement('div'); option.className='currency-option'; option.dataset.currency=currency; option.innerHTML=` <iconify-icon icon="${currencyIcons[currency] || 'ph:currency-circle-dollar'}" width="20" height="20"></iconify-icon><span>${currency} - ${currencyNames[currency] || currency}</span>`; option.addEventListener('click', ()=>{ baseCurrency=currency; baseCurrencyBtn.innerHTML=` <iconify-icon icon="${currencyIcons[currency] || 'ph:currency-circle-dollar'}" width="20" height="20"></iconify-icon><span>基准货币：${currency}</span><iconify-icon icon="ph:caret-down" width="16" height="16"></iconify-icon>`; currencyDropdown.classList.remove('show'); fetchExchangeRates();}); currencyDropdown.appendChild(option);});} // 生成货币卡片 function generateCurrencyCards(){ primaryCurrencies.innerHTML=''; secondaryCurrencies.innerHTML=''; // 创建主要货币卡片（第一行：基准货币、人民币和比特币）createPrimaryCurrencyCard(baseCurrency); createPrimaryCurrencyCard('CNY'); createBitcoinCard(); // 其他货币（排除第一行已经显示的货币）const otherCurrencies=currencies.filter(currency=>currency !==baseCurrency && currency !=='CNY' && currency !=='BTC' ); // 按字母顺序排序其他货币 otherCurrencies.sort(); // 创建其他货币卡片 otherCurrencies.forEach(currency=>{ createSecondaryCurrencyCard(currency);});} // 创建主货币卡片（第一行）function createPrimaryCurrencyCard(currency){ const currencyCard=document.createElement('div'); currencyCard.className=`primary-currency-card ${currency.toLowerCase()}`; currencyCard.dataset.currency=currency; // 计算汇率显示 const rate=exchangeRates[currency] || 0; currencyCard.innerHTML=` <div class="currency-header"><div class="currency-flag"><iconify-icon icon="${currencyIcons[currency] || 'ph:currency-circle-dollar'}" width="28" height="28"></iconify-icon></div><div class="currency-info"><div class="currency-code">${currency} - ${currencyNames[currency] || currency}</div><div class="currency-name">${currency===baseCurrency ? '基准货币' : currencyNames[currency] ? currencyNames[currency] : ''}</div></div></div><input type="number" class="currency-input" placeholder="输入金额" min="0" data-currency="${currency}" ${currency===baseCurrency ? 'value="1"' : ''} ><div class="currency-rate">1 USD=${rate.toFixed(4)} ${currency}</div>`; primaryCurrencies.appendChild(currencyCard); // 添加事件监听器 const inputEl=currencyCard.querySelector('.currency-input'); // 实时换算，且不覆盖当前输入框 inputEl.addEventListener('input', function(){ const value=this.value; const currency=this.dataset.currency; if (value===''){ document.querySelectorAll('.currency-input').forEach(input=>input.value=''); updateAllCurrencyRates(currency); return;} let num=parseFloat(value); if (isNaN(num) || num < 0) num=0; updateAllCurrencies(currency, num, this); // 传递当前输入框 updateAllCurrencyRates(currency);}); inputEl.addEventListener('blur', function(){ handleCurrencyInputFinish(this);}); inputEl.addEventListener('keydown', function(e){ if (e.key==='Enter'){ this.blur(); // 触发 blur 事件}}); function handleCurrencyInputFinish(input){ let value=input.value; const currency=input.dataset.currency; if (value===''){ document.querySelectorAll('.currency-input').forEach(input=>input.value=''); updateAllCurrencyRates(currency); return;} value=parseFloat(value); if (isNaN(value) || value < 0) value=0; updateAllCurrencies(currency, value); updateAllCurrencyRates(currency);}} // 创建比特币卡片 function createBitcoinCard(){ const currencyCard=document.createElement('div'); currencyCard.className='primary-currency-card btc'; currencyCard.dataset.currency='BTC'; currencyCard.innerHTML=` <div class="currency-header"><div class="currency-flag btc-flag"><iconify-icon icon="cryptocurrency:btc" width="28" height="28"></iconify-icon></div><div class="currency-info"><div class="currency-code btc-code">BTC - 比特币 <a href="https://blockchain.info/ticker" target="_blank" rel="noopener noreferrer">API</a></div><div class="currency-name">比特币汇率每 15 分钟更新一次</div></div></div><input type="number" class="currency-input" placeholder="输入金额" min="0" data-currency="BTC" style="display: none;" ><div class="currency-rate" style="text-align: center; margin-top: 20px;">比特币汇率未加载 </div><button class="btc-load-btn" id="loadBtcBtn"><iconify-icon icon="mdi:check-circle" width="20" height="20"></iconify-icon><span>加载比特币汇率</span></button>`; primaryCurrencies.appendChild(currencyCard); // 添加比特币加载按钮事件 document.getElementById('loadBtcBtn').addEventListener('click', function(){ this.innerHTML='<div class="spinner btc-spinner" style="width:20px;height:20px;"></div>加载中...'; this.disabled=true; fetchBitcoinRates();}); // 添加输入事件监听器 const inputEl=currencyCard.querySelector('.currency-input'); // 实时换算，且不覆盖当前输入框 inputEl.addEventListener('input', function(){ const value=this.value; if (value===''){ document.querySelectorAll('.currency-input').forEach(input=>input.value=''); updateAllCurrencyRates('BTC'); return;} let num=parseFloat(value); if (isNaN(num) || num < 0) num=0; updateAllCurrencies('BTC', num, this); // 传递当前输入框 updateAllCurrencyRates('BTC');}); // 可选：失去焦点或回车时可做校验（不再做换算）inputEl.addEventListener('blur', function(){ // 可做格式校验或补零等}); inputEl.addEventListener('keydown', function(e){ if (e.key==='Enter'){ this.blur();}});} // 创建次要货币卡片 function createSecondaryCurrencyCard(currency){ const currencyCard=document.createElement('div'); currencyCard.className=`currency-card`; currencyCard.dataset.currency=currency; // 计算汇率显示 const rate=exchangeRates[currency] || 0; currencyCard.innerHTML=` <div class="currency-header"><div class="currency-flag"><iconify-icon icon="${currencyIcons[currency] || 'ph:currency-circle-dollar'}" width="24" height="24"></iconify-icon></div><div class="currency-info"><div class="currency-code">${currency}</div><div class="currency-name">${currencyNames[currency] || currency}</div></div></div><input type="number" class="currency-input" placeholder="输入金额" min="0" data-currency="${currency}" ><div class="currency-rate">1 USD=${rate.toFixed(4)} ${currency}</div>`; secondaryCurrencies.appendChild(currencyCard); // 添加事件监听器 const inputEl=currencyCard.querySelector('.currency-input'); // 实时换算，且不覆盖当前输入框 inputEl.addEventListener('input', function(){ const value=this.value; const currency=this.dataset.currency; if (value===''){ document.querySelectorAll('.currency-input').forEach(input=>input.value=''); updateAllCurrencyRates(currency); return;} let num=parseFloat(value); if (isNaN(num) || num < 0) num=0; updateAllCurrencies(currency, num, this); // 传递当前输入框 updateAllCurrencyRates(currency);}); // 可选：失去焦点或回车时可做校验（不再做换算）inputEl.addEventListener('blur', function(){ // 可做格式校验或补零等}); inputEl.addEventListener('keydown', function(e){ if (e.key==='Enter'){ this.blur();}});} // 更新所有货币汇率显示 function updateAllCurrencyRates(base=baseCurrency){ // 更新第一行卡片 document.querySelectorAll('.primary-currency-card').forEach(card=>{ const currency=card.dataset.currency; let rate=0; if (exchangeRates[base] && exchangeRates[currency]){ rate=exchangeRates[currency] / exchangeRates[base];} card.querySelector('.currency-rate').textContent=`1 ${base}=${rate.toFixed(4)} ${currency}`;}); // 更新其他货币卡片 document.querySelectorAll('.currency-card').forEach(card=>{ const currency=card.dataset.currency; let rate=0; if (exchangeRates[base] && exchangeRates[currency]){ rate=exchangeRates[currency] / exchangeRates[base];} card.querySelector('.currency-rate').textContent=`1 ${base}=${rate.toFixed(4)} ${currency}`;});} // 更新所有货币值 function updateAllCurrencies(sourceCurrency, sourceValue, activeInput){ if (sourceCurrency==='BTC'){ updateCurrencyValues(sourceValue, 'BTC', activeInput);} else{ const btcValue=sourceValue / exchangeRates[sourceCurrency]; updateCurrencyValues(btcValue, sourceCurrency, activeInput);}} // 更新所有货币输入值 function updateCurrencyValues(btcValue, activeCurrency, activeInput){ // 更新第一行卡片 document.querySelectorAll('.primary-currency-card').forEach(card=>{ const currency=card.dataset.currency; const input=card.querySelector('.currency-input'); if (currency==='BTC' && !exchangeRates['BTC']) return; if (input===activeInput) return; // 跳过当前输入框 if (currency !=='BTC'){ const rate=exchangeRates[currency]; input.value=(btcValue * rate).toFixed(4);} else{ input.value=btcValue.toFixed(8);}}); // 更新其他货币卡片 document.querySelectorAll('.currency-card').forEach(card=>{ const currency=card.dataset.currency; const input=card.querySelector('.currency-input'); if (input===activeInput) return; // 跳过当前输入框 const rate=exchangeRates[currency]; input.value=(btcValue * rate).toFixed(4);});} // 事件监听器 baseCurrencyBtn.addEventListener('click', ()=>{ currencyDropdown.classList.toggle('show');}); // 点击外部关闭下拉菜单 document.addEventListener('click', (event)=>{ if (!baseCurrencyBtn.contains(event.target) && !currencyDropdown.contains(event.target)){ currencyDropdown.classList.remove('show');}}); // 初始化 fetchExchangeRates(); </script></body></html>
