---
authors:
- eallion
categories:
- 日志
date: '2017-05-12 20:12:00'
draft: false
lastmod: '2017-05-12 20:12:00'
slug: typecho-anti-spam
summary: 为了应对每天数千条垃圾评论的困扰，采取了严格的评论过滤措施，主要依赖 Akismet 和 CommentFilter 两款插件。Akismet 作为久经考验的云服务能有效拦截大部分垃圾评论，而
  CommentFilter 则通过屏蔽机器人、IP、非中文内容及敏感词汇进一步防护，但为避免误伤正常评论，多数规则仅触发审核而非直接拦截。
tags:
- 评论
- 留言
- spam
- 垃圾评论
title: typecho 应对垃圾评论
---
最近真的烦，每天有几千的垃圾评论，我也是醉了。所以把评论条件搞得很严格，也不知道会不会对用户体验产生多少负面影响，也不知道会不会误伤夹杂在其实的正常评论。如果有的话，真的表示抱歉。

主要防 spam 的手段从 2 个方面，从 2 个插件入手。

### Akismet

Akismet 确实是一个神器，从 WordPress 黄金时代开始，Akismet 久经考验，功能强大，基于云功能，能防御大部分垃圾评论。
跟 Akismet 差不多的还有 Typepad。

### CommentFilter

这个插件有几个方面主要功能

- 屏蔽机器人评论
- 屏蔽 IP
- 非中文评论
- 禁止词汇
- 敏感词汇

除了禁止词汇，直接返回失败，其他的功能，如果评论满足条件都只是标记为待审核。因为真的怕误伤朋友的评论。其中屏蔽的 ip 库我是已经数不过来了。

### 其他插件

然后跟评论有关的插件是

- AjaxComment

Ajax 对提升用户体验有一定的帮助，它可以让访客在不刷新当前页面的情况下提交评论。但是这个目前跟我的主题有冲突，就是如果直接回复评论的话，评论嵌套功能就不能生效，目前没有动手去修改这个插件，将就在用的。

- CommentToMail

评论邮件提醒插件。
我最开始用的是 Gmail 的 smtp 服务器，因为我的域名邮箱是放在 Google G suite 的，但是后来有朋友反映 hotmail 收不到我博客的提醒邮件，于是我就把邮件提醒的 smtp 服务器改为阿里云的邮件推送服务了。

- UserAgent

这个是显示评论者的操作系统和浏览器图标的，插件发布得比较早，数据有点老，所以比如常见的最新的 Ubuntu 16.04 图标就不能正确显示，除了动手添加了几个浏览器的图标以外，并没有修复不能识别操作系统的问题。
这个插件只是好玩，并没有什么实际作用。