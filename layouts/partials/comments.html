
<div id="comment" class="border border-gray-200 dark:border-border-dimmed-primary p-8 bg-zinc-100 dark:bg-bg-dimmed-secondary rounded-2xl my-8 md:my-14">

<h2 class="text-xl font-semibold">评论</h2>

<div class="comment-on flex flex-col md:flex-row items-center mt-8 text-base capitalize print:hidden">
    <div id="load-giscus" class="inline-flex items-center relative border dark:border-border-dimmed-subtle bg-white dark:bg-bg-dimmed-primary rounded-full px-4 py-2 hover:bg-zinc-200 dark:hover:bg-bg-dimmed-subtle">
        <span class="cursor-pointer">点击加载</span>
        <span class="ml-2 mr-1 cursor-pointer"><span class="relative block icon">{{ partial "icon.html" (dict "name" "giscus" "class" "") }}</span></span>
        <span class='opacity-75 hover:opacity-100 cursor-pointer duration-300 ease-in-out'>Giscus</span>
    </div>
    <div id="load-giscus-desc" class="block md:inline-block text-sm md:text-base lowercase md:capitalize m-4">或者</div>
    <div id="link-to-mastodon" class="flex items-center relative border dark:border-border-dimmed-subtle bg-white dark:bg-bg-dimmed-primary rounded-full px-4 py-2 hover:bg-zinc-200 dark:hover:bg-bg-dimmed-subtle">
        <span class="cursor-pointer">去</span>
        <span class="ml-2 mr-1 cursor-pointer"><span class="relative block icon">{{ partial "icon.html" (dict "name" "mastodon-color" "class" "") }}</span></span>
        <span class='ml-1 opacity-75 hover:opacity-100 cursor-pointer duration-300 ease-in-out'>
            <a href="https://api.eallion.com/gts/{{ .Params.slug | default .File.TranslationBaseName }}" target="_blank" rel="noopener">Mastodon</a>
        </span>
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M18 5v2h5.563L11.28 19.281l1.438 1.438L25 8.437V14h2V5zM5 9v18h18V14l-2 2v9H7V11h9l2-2z"/></svg></span>
        <span class="cursor-pointer ml-1">讨论</span>
    </div>
</div>
<div id="comments" class=""></div>
</div>
<script>
    function loadGiscus() {
        return new Promise((resolve) => {
            const script = document.createElement('script');
            script.src = 'https://giscus.app/client.js';
            script.setAttribute('data-repo', 'eallion/eallion.com');
            script.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkyNjI2Njk1MDg=');
            script.setAttribute('data-category', 'Giscus');
            script.setAttribute('data-category-id', 'DIC_kwDOD6gExM4CS9eF');
            script.setAttribute('data-mapping', 'pathname');
            script.setAttribute('data-strict', '1');
            script.setAttribute('data-reactions-enabled', '0');
            script.setAttribute('data-emit-metadata', '0');
            script.setAttribute('data-input-position', 'bottom');
            script.setAttribute('data-lang', 'zh-CN');
            script.setAttribute('data-loading', 'lazy');
            script.setAttribute('crossorigin', 'anonymous');
            script.async = true;

            const htmlElement = document.documentElement;
            if (htmlElement.classList.contains('dark')) {
                script.setAttribute('data-theme', 'dark_dimmed');
            } else {
                script.setAttribute('data-theme', 'light');
            }

            script.addEventListener('load', () => {
                resolve();
            });

            document.getElementById('comments').appendChild(script);
        });
    }

    document.getElementById('load-giscus').addEventListener('click', async () => {
        await loadGiscus();
        document.getElementById('load-giscus').classList.add('hidden!');
        document.getElementById('load-giscus-desc').classList.add('hidden!');
        document.getElementById('link-to-mastodon').classList.add('mb-8');
    });
</script>
